[
    {
        "name": "Rout",
        "trigger": "combat_end",
        "level_nid": "1",
        "condition": "{v:RoutEnemies} == 0",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "if;len(game.get_enemy_units()) == 1 and game.check_alive('Brassfield') and u('Brassfield').team == 'enemy'",
            "    flicker_cursor;Brassfield",
            "    wait;250",
            "    transition;close",
            "    change_background;TownNight",
            "    transition;open",
            "    add_portrait;Brassfield;Right",
            "    speak;Brassfield;...",
            "    remove_portrait;Brassfield",
            "    transition;open",
            "    wait;250",
            "    remove_unit;Brassfield;immediate;south",
            "    inc_level_var;RoutEnemies;1",
            "    win_game",
            "elif;len(game.get_enemy_units()) == 0",
            "    win_game",
            "end",
            ""
        ]
    }
]