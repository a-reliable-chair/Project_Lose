[
    {
        "name": "SkillQuinley",
        "trigger": "unit_death",
        "level_nid": null,
        "condition": "unit.team == 'enemy' and unit2.nid == 'Quinley'",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "if;{v:QuinleySkill} == 0 and 'Boss' in unit.tags",
            "    remove_unit;{unit}",
            "    resurrect;{unit}",
            "    change_team;{unit};player",
            "    remove_tag;{unit};Boss",
            "    for;Current_Skill;[u.nid for u in u('{unit}').skills]",
            "        remove_skill;{unit};{Current_Skill};no_banner",
            "    endf",
            "    give_skill;{unit};Thrall;no_banner",
            "    give_skill;{unit};Flying;no_banner",
            "    add_unit;{unit};Quinley;warp;closest",
            "    inc_level_var;QuinleySkill;1",
            "    wait;200",
            "elif;{v:QuinleySkill} == 0 and 'Boss' not in unit.tags",
            "    remove_unit;{unit}",
            "    resurrect;{unit}",
            "    change_team;{unit};player",
            "    recruit_generic;{unit};Thrall;Thrall",
            "    change_faction;Thrall;Thrall;no_warn",
            "    change_portrait;Thrall;Thrall",
            "    for;Current_Skill;[u.nid for u in u('Thrall').skills]",
            "        remove_skill;Thrall;{Current_Skill};no_banner",
            "    endf",
            "    give_skill;Thrall;Thrall;no_banner",
            "    give_skill;Thrall;Flying;no_banner",
            "    give_skill;Thrall;Canto;no_banner",
            "    add_unit;{unit};Quinley;warp;closest",
            "    inc_level_var;QuinleySkill;1",
            "    wait;200",
            "end",
            "if;len(unit.items) == 0 and game.level.nid == '1'",
            "    if;unit.wexp['Sword'] > 0",
            "        give_item;{unit};Iron Sword;no_banner",
            "    elif;unit.wexp['Lance'] > 0",
            "        give_item;{unit};Iron Lance;no_banner",
            "    elif;unit.wexp['Axe'] > 0",
            "        give_item;{unit};Iron Axe;no_banner",
            "    elif;unit.wexp['Bow'] > 0",
            "        give_item;{unit};Iron Bow;no_banner",
            "    elif;unit.wexp['Light'] > 0",
            "        give_item;{unit};Flash;no_banner",
            "    elif;unit.wexp['Anima'] > 0",
            "        give_item;{unit};Entangle;no_banner",
            "    elif;unit.wexp['Dark'] > 0",
            "        give_item;{unit};Jinx;no_banner",
            "    end",
            "elif;len(unit.items) == 0 and game.level.nid == '2' or game.level.nid == 'DEBUG'",
            "    if;unit.wexp['Sword'] > 0",
            "        give_item;{unit};Steel Sword;no_banner",
            "    elif;unit.wexp['Lance'] > 0",
            "        give_item;{unit};Steel Lance;no_banner",
            "    elif;unit.wexp['Axe'] > 0",
            "        give_item;{unit};Steel Axe;no_banner",
            "    elif;unit.wexp['Bow'] > 0",
            "        give_item;{unit};Steel Bow;no_banner",
            "    elif;unit.wexp['Light'] > 0",
            "        give_item;{unit};Shimmer;no_banner",
            "    elif;unit.wexp['Anima'] > 0",
            "        give_item;{unit};Fire;no_banner",
            "    elif;unit.wexp['Dark'] > 0",
            "        give_item;{unit};Luna;no_banner",
            "    end",
            "elif;len(unit.items) == 0 and game.level.nid == '4'",
            "    if;unit.wexp['Sword'] > 0",
            "        give_item;{unit};Silver Sword;no_banner",
            "    elif;unit.wexp['Lance'] > 0",
            "        give_item;{unit};Silver Lance;no_banner",
            "    elif;unit.wexp['Axe'] > 0",
            "        give_item;{unit};Silver Axe;no_banner",
            "    elif;unit.wexp['Bow'] > 0",
            "        give_item;{unit};Silver Bow;no_banner",
            "    elif;unit.wexp['Light'] > 0",
            "        give_item;{unit};ShiningBind;no_banner",
            "    elif;unit.wexp['Anima'] > 0",
            "        give_item;{unit};Cataclysm;no_banner",
            "    elif;unit.wexp['Dark'] > 0",
            "        give_item;{unit};Evanesce;no_banner",
            "    end",
            "end"
        ]
    }
]