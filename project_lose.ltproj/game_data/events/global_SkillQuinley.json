[
    {
        "name": "SkillQuinley",
        "trigger": "unit_death",
        "level_nid": null,
        "condition": "unit.team == 'enemy' and unit2.nid == 'Quinley' and u('Quinley').position and game.phase.get_current() == 'player'\n",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "if;{v:Enthrall} == 0 and 'Boss' in unit.tags",
            "    remove_unit;{unit}",
            "    resurrect;{unit}",
            "    change_team;{unit};player",
            "    remove_tag;{unit};Boss",
            "    for;Current_Skill;[u.nid for u in u('{unit}').skills]",
            "        remove_skill;{unit};{Current_Skill};no_banner",
            "    endf",
            "    give_skill;{unit};Thrall;no_banner",
            "    give_skill;{unit};Flying;no_banner",
            "    give_skill;{unit};Shove;no_banner",
            "    add_unit;{unit};Quinley;warp;closest",
            "    inc_level_var;QuinleySkill;1",
            "    wait;200",
            "elif;{v:Enthrall} == 0 and 'Boss' not in unit.tags",
            "    remove_unit;{unit}",
            "    resurrect;{unit}",
            "    change_team;{unit};player",
            "    recruit_generic;{unit};Thrall;Thrall",
            "    change_faction;Thrall;Thrall;no_warn",
            "    for;Current_Skill;[u.nid for u in u('Thrall').skills]",
            "        remove_skill;Thrall;{Current_Skill};no_banner",
            "    endf",
            "    give_skill;Thrall;Thrall;no_banner",
            "    give_skill;Thrall;Flying;no_banner",
            "    give_skill;Thrall;Canto;no_banner",
            "    give_skill;Thrall;Shove;no_banner",
            "    add_unit;{unit};Quinley;warp;closest",
            "    inc_level_var;Enthrall;1",
            "    if;unit.klass == 'Myrmidon'",
            "        change_portrait;Thrall;TMyrmidon",
            "    elif;unit.klass == 'Mercenary'",
            "        change_portrait;Thrall;TMercenary",
            "    elif;unit.klass == 'Knight'",
            "        change_portrait;Thrall;TKnight",
            "    elif;unit.klass == 'Soldier'",
            "        change_portrait;Thrall;TSoldier",
            "    elif;unit.klass == 'Fighter'",
            "        change_portrait;Thrall;TFighter",
            "    elif;unit.klass == 'Pirate'",
            "        change_portrait;Thrall;TPirate",
            "    elif;unit.klass == 'Archer'",
            "        change_portrait;Thrall;TArcher",
            "    elif;unit.klass == 'Cavalier'",
            "        change_portrait;Thrall;TCavalier",
            "    elif;unit.klass == 'Monk'",
            "        change_portrait;Thrall;TMonk",
            "    elif;unit.klass == 'Mage'",
            "        change_portrait;Thrall;TMage",
            "    elif;unit.klass == 'Shaman'",
            "        change_portrait;Thrall;TShaman",
            "    elif;unit.klass == 'Cleric'",
            "        change_portrait;Thrall;TCleric",
            "    elif;unit.klass == 'Thief'",
            "        change_portrait;Thrall;TThief",
            "    elif;unit.klass == 'PegasusKnight'",
            "        change_portrait;Thrall;TPegasus",
            "    elif;unit.klass == 'Dracoknight'",
            "        change_portrait;Thrall;TWyvern",
            "    elif;unit.klass == 'GriffonKnight'",
            "        change_portrait;Thrall;TGriffon",
            "    end",
            "    wait;200",
            "end",
            "if;len(unit.items) == 0",
            "    if;game.level.nid == '1'",
            "        if;unit.wexp['Sword'] > 0",
            "            give_item;{unit};Iron Sword;no_banner",
            "        elif;unit.wexp['Lance'] > 0",
            "            give_item;{unit};Iron Lance;no_banner",
            "        elif;unit.wexp['Axe'] > 0",
            "            give_item;{unit};Iron Axe;no_banner",
            "        elif;unit.wexp['Bow'] > 0",
            "            give_item;{unit};Iron Bow;no_banner",
            "        elif;unit.wexp['Light'] > 0",
            "            give_item;{unit};Flash;no_banner",
            "        elif;unit.wexp['Anima'] > 0",
            "            give_item;{unit};Entangle;no_banner",
            "        elif;unit.wexp['Dark'] > 0",
            "            give_item;{unit};Jinx;no_banner",
            "        end",
            "    elif;game.level.nid == '2' or game.level.nid == '3'",
            "        if;unit.wexp['Sword'] > 0",
            "            give_item;{unit};Steel Sword;no_banner",
            "        elif;unit.wexp['Lance'] > 0",
            "            give_item;{unit};Steel Lance;no_banner",
            "        elif;unit.wexp['Axe'] > 0",
            "            give_item;{unit};Steel Axe;no_banner",
            "        elif;unit.wexp['Bow'] > 0",
            "            give_item;{unit};Steel Bow;no_banner",
            "        elif;unit.wexp['Light'] > 0",
            "            give_item;{unit};Shimmer;no_banner",
            "        elif;unit.wexp['Anima'] > 0",
            "            give_item;{unit};Fire;no_banner",
            "        elif;unit.wexp['Dark'] > 0",
            "            give_item;{unit};Luna;no_banner",
            "        end",
            "    elif;game.level.nid == '4'",
            "        if;unit.wexp['Sword'] > 0",
            "            give_item;{unit};Silver Sword;no_banner",
            "        elif;unit.wexp['Lance'] > 0",
            "            give_item;{unit};Silver Lance;no_banner",
            "        elif;unit.wexp['Axe'] > 0",
            "            give_item;{unit};Silver Axe;no_banner",
            "        elif;unit.wexp['Bow'] > 0",
            "            give_item;{unit};Silver Bow;no_banner",
            "        elif;unit.wexp['Light'] > 0",
            "            give_item;{unit};ShiningBind;no_banner",
            "        elif;unit.wexp['Anima'] > 0",
            "            give_item;{unit};Wind;no_banner",
            "        elif;unit.wexp['Dark'] > 0",
            "            give_item;{unit};Evanesce;no_banner",
            "        end",
            "    end",
            "end"
        ]
    }
]