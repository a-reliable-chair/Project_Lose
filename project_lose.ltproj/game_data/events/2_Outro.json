[
    {
        "name": "Outro",
        "trigger": "level_end",
        "level_nid": "2",
        "condition": "True",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "remove_all_units",
            "change_background;TownSunset",
            "music;Pandemonium",
            "transition;open",
            "if;{v:GotReclaimer} == 0",
            "    # If the player got the Reclaimer relic they talk about how they got it, but nobody among them can even use it.",
            "    multi_add_portrait;Alpin;FarLeft;Elwynn;MidLeft;Saraid;FarRight;Quinley;MidRight",
            "    speak;Elwynn;We failed!",
            "end",
            "multi_remove_portrait;Alpin;Elwynn;Saraid;Quinley",
            "if;{v:GotReclaimer} == 1",
            "    multi_add_portrait;Alpin;FarLeft;Elwynn;MidLeft;Saraid;FarRight;Quinley;MidRight",
            "    # Party fucked up, no dope lance for them (that they couldn't use)",
            "    speak;Elwynn;We succeeded!",
            "    multi_remove_portrait;Alpin;Elwynn;Saraid;Quinley",
            "end",
            "if;{v:LeodDead} == 1",
            "    # Garvey gives Elspeth a Debilitate staff he found amidst the chaos if they're both alive.",
            "    multi_add_portrait;Elspeth;Left;Garvey;Right",
            "    speak;Garvey;Found dis.",
            "    speak;Elspeth;K thx.",
            "    #give_item;Elspeth (Elspeth);",
            "    multi_remove_portrait;Elspeth;Garvey",
            "    transition;close",
            "    change_background",
            "end",
            "if;{v:LeodDead} == 0",
            "    multi_add_portrait;Lamonte;Right;Elspeth;Left",
            "    # If Leod survived Ch 2 the party talk about how they left him in the office.",
            "    # Lamonte gives Elspeth an Inspire Courage staff he found amidst the chaos if they're both alive.",
            "    speak;Lamonte;filler",
            "    speak;Elspeth;filler",
            "    #give_item;Elspeth (Elspeth);",
            "    multi_remove_portrait;Lamonte;Elspeth",
            "    transition;close",
            "    change_background",
            "    change_tilemap;Church Office",
            "    add_unit;Leod;7, 5;immediate",
            "    add_weather;fire",
            "    transition;open;500",
            "    flicker_cursor;Leod",
            "    add_portrait;Leod;Left",
            "    # Leod's wakes up, barred in a burning office. Starts running around pounding on the front and back doors.",
            "    speak;Leod;filler",
            "    remove_portrait;Leod",
            "    move_unit;Leod;7, 8;normal;push;60",
            "    add_portrait;Leod;Left",
            "    bop_portrait;Leod",
            "    speak;Leod;filler!",
            "    bop_portrait;Leod",
            "    speak;Leod;Filler!!",
            "    bop_portrait;Leod",
            "    speak;Leod;Filler!!!!",
            "    remove_portrait;Leod",
            "    move_unit;Leod;5, 3;normal;push;60",
            "    add_portrait;Leod;Left",
            "    speak;Leod;IT'S LOCKED!",
            "    bop_portrait;Leod",
            "    speak;Leod;AHHHHHHHHH!",
            "    remove_portrait;Leod",
            "    # Leod burns to death :D",
            "    transition;close;5000;255, 0, 0",
            "    kill_unit;Leod;immediate",
            "end",
            "change_tilemap;Ch2",
            "# No text prompts here but if you want to add anything when the party actually leaves I can tweak the eventing.",
            "# It's now morning and they're headed to the Market / Pier",
            "show_layer;Boxes",
            "show_layer;Mid",
            "add_weather;sunset",
            "enable_fog_of_war;0",
            "move_cursor;11, 12",
            "transition;open",
            "wait;500",
            "add_unit;Alpin;11, 12;immediate;stack",
            "add_unit;Carlin;11, 12;immediate;stack",
            "add_unit;Shayla;11, 12;immediate;stack",
            "add_unit;Raelin;11, 12;immediate;stack",
            "add_unit;Elwynn;11, 12;immediate;stack",
            "add_unit;Elspeth;11, 12;immediate;stack",
            "add_unit;Quinley;11, 12;immediate;stack",
            "add_unit;Saraid;11, 12;immediate;stack",
            "if;{v:LeodDead} == 0",
            "    add_unit;Lamonte;11, 12;immediate;stack",
            "end",
            "if;{v:LeodDead} == 1",
            "    add_unit;Garvey;11, 12;immediate;stack",
            "end",
            "move_unit;Alpin;14, 17;normal;stack;no_block",
            "move_unit;Carlin;15, 17;normal;stack;no_block",
            "move_unit;Shayla;16, 17;normal;stack;no_block",
            "move_unit;Raelin;17, 17;normal;stack;no_block",
            "move_unit;Elwynn;14, 17;normal;stack;no_block",
            "move_unit;Elspeth;15, 17;normal;stack;no_block",
            "move_unit;Quinley;16, 17;normal;stack;no_block",
            "move_unit;Saraid;17, 17;normal;stack;no_block",
            "if;{v:LeodDead} == 0",
            "    move_unit;Lamonte;15, 17;normal;stack",
            "end",
            "if;{v:LeodDead} == 1",
            "    move_unit;Garvey;14, 17;normal;stack",
            "end",
            "remove_unit;Alpin;fade;south",
            "remove_unit;Carlin;fade;south",
            "remove_unit;Shayla;fade;south",
            "remove_unit;Raelin;fade;south",
            "remove_unit;Elwynn;fade;south",
            "remove_unit;Quinley;fade;south",
            "remove_unit;Saraid;fade;south",
            "remove_unit;Elspeth;fade;south",
            "if;{v:LeodDead} == 0",
            "    remove_unit;Lamonte;fade;south",
            "end",
            "if;{v:LeodDead} == 1",
            "    remove_unit;Garvey;fade;south",
            "end",
            "wait;500",
            "# Castle",
            "# Laisren makes it to the castle and tells the soldiers of the invasion and is allowed inside.",
            "change_tilemap;Castle Exterior",
            "add_unit;Kingdom_1;3, 3;immediate",
            "add_unit;Kingdom_2;3, 8;immediate",
            "add_unit;Kingdom_3;8, 9;immediate",
            "add_unit;Kingdom_4;10, 9;immediate",
            "add_unit;Kingdom_5;3, 0;immediate",
            "add_unit;Kingdom_6;4, 9;immediate",
            "add_unit;Kingdom_7;8, 3;immediate",
            "add_unit;Kingdom_8;10, 3;immediate",
            "transition;open;500",
            "add_unit;Laisren;9, 11;fade;push;south",
            "wait;500",
            "move_unit;Laisren;9, 10;normal;push",
            "wait;500",
            "add_portrait;Laisren;Left",
            "add_portrait;SoldierBlue;MidRight",
            "add_portrait;SoldierRed;FarRight",
            "speak;SoldierBlue;Laisren!",
            "speak;Laisren;Invaded!",
            "bop_portrait;SoldierRed",
            "speak;SoldierRed;Pass!",
            "speak;Laisren;Yes, sir!",
            "multi_remove_portrait;Laisren;SoldierBlue;SoldierRed",
            "move_unit;Laisren;9, 4;normal;push",
            "wait;500",
            "add_portrait;Laisren;Left",
            "add_portrait;SoldierBlue;MidRight",
            "add_portrait;SoldierRed;FarRight",
            "speak;SoldierBlue;Laisren!",
            "speak;Laisren;Invaded!",
            "bop_portrait;SoldierRed",
            "speak;SoldierRed;Hurry inside!",
            "speak;Laisren;Yes, sir!",
            "multi_remove_portrait;Laisren;SoldierBlue;SoldierRed",
            "move_unit;Laisren;9, 2;normal;push",
            "wait;500",
            "remove_unit;Laisren;immediate",
            "wait;500",
            "transition;close;500",
            "remove_all_units",
            "change_tilemap;Castle Interior",
            "add_unit;King;8, 4;immediate",
            "add_unit;Keeva;7, 4;immediate",
            "add_unit;Kingdom_9;1, 3;immediate",
            "add_unit;Kingdom_10;10, 8;immediate",
            "add_unit;Kingdom_11;3, 3;immediate",
            "add_unit;Kingdom_12;6, 8;immediate",
            "add_unit;Kingdom_13;6, 17;immediate",
            "add_unit;Kingdom_14;10, 17;immediate",
            "add_unit;Kingdom_15;6, 13;immediate",
            "add_unit;Kingdom_16;10, 13;immediate",
            "add_unit;Kingdom_17;0, 7;immediate",
            "add_unit;Kingdom_18;16, 9;immediate",
            "add_unit;Kingdom_19;16, 11;immediate",
            "add_unit;Kingdom_20;0, 4;immediate",
            "add_unit;Kingdom_21;3, 6;immediate",
            "add_unit;Kingdom_22;12, 5;immediate",
            "add_unit;Kingdom_23;4, 5;immediate",
            "add_unit;Kingdom_24;13, 6;immediate",
            "move_cursor;King;immediate",
            "transition;open;500",
            "wait;500",
            "move_cursor;8, 17",
            "add_unit;Laisren;8, 17",
            "wait;500",
            "move_unit;Laisren;8, 10",
            "move_cursor;King",
            "wait;500",
            "multi_add_portrait;Laisren;Right;King;Left",
            "# Once inside, Laisren's at the throneroom with the King, Keeva, and other knights.",
            "# Laisren tells him of the invasion, he expects reinforcements for the town but the king tells him to stay here and defend the castle; mentioning he's heard great things of Laisren and that he'll someday become a high ranking officer",
            "# Laisren refuses and questions how the king could abandon his people.",
            "speak;Laisren;Milord!",
            "move_portrait;King;MidLeft",
            "add_portrait;Keeva;FarLeft",
            "speak;Keeva;filler",
            "speak;Laisren;Milord, village invaded...",
            "multi_remove_portrait;Laisren;King;Keeva",
            "move_unit;King;8, 8;normal;push;no_follow",
            "move_unit;Keeva;7, 7;normal;push;no_follow",
            "music;For The Greater Good",
            "wait;500",
            "multi_add_portrait;Laisren;Right;King;Left",
            "# The king gives a speech about how sacrifices are necessary for the greater good of the kingdom (or whatever along those lines)",
            "# King tells Laisren to get in line",
            "# Laisren retorts with some humanitarian response and refuses. Then he tries to leave.",
            "speak;King;Speech",
            "multi_remove_portrait;Laisren;King",
            "music;Pandemonium",
            "move_unit;Laisren;8, 12;normal;no_block;no_follow",
            "move_unit;Kingdom_15;8, 13;normal;no_block;no_follow",
            "move_unit;Kingdom_16;9, 13;normal",
            "wait;500",
            "multi_add_portrait;SoldierBlue;FarLeft;SoldierRed;MidLeft;Laisren;Right",
            "# Soldiers stop Laisren on his way out",
            "speak;SoldierBlue;Halt!",
            "multi_remove_portrait;SoldierBlue;SoldierRed;Laisren",
            "wait;500",
            "flicker_cursor;King",
            "wait;500",
            "add_portrait;King;Left",
            "# King tells them to let him go, he has no use for a soldier who won't follow orders (or whatever)",
            "speak;King;filler",
            "remove_portrait;King",
            "wait;500",
            "move_unit;Kingdom_15;7, 13;normal;no_block",
            "move_unit;Kingdom_16;10, 13;normal",
            "wait;500",
            "move_unit;Laisren;8, 17;normal;push",
            "wait;500",
            "remove_unit;Laisren;fade;south",
            "wait;500",
            ""
        ]
    }
]