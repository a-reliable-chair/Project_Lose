[
    {
        "name": "Outro",
        "trigger": "level_end",
        "level_nid": "2",
        "condition": "True",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "remove_all_units",
            "change_background;TownSunset",
            "transition;open",
            "if;{v:GotReclaimer} == 0",
            "# If the player got the Reclaimer relic they talk about how they got it, but nobody among them can even use it.",
            "multi_add_portrait;Alpin;FarLeft;Elwynn;MidLeft;Sloane;FarRight;Quinley;MidRight",
            "speak;Elwynn;We failed!",
            "end",
            "multi_remove_portrait;Alpin;Elwynn;Sloane;Quinley",
            "if;{v:GotReclaimer} == 1",
            "multi_add_portrait;Alpin;FarLeft;Elwynn;MidLeft;Sloane;FarRight;Quinley;MidRight",
            "# Party fucked up, no dope lance for them (that they couldn't use)",
            "speak;Elwynn;We succeeded!",
            "multi_remove_portrait;Alpin;Elwynn;Sloane;Quinley",
            "end",
            "if;{v:LeodDead} == 1",
            "# Garvey gives Elspeth a Debilitate staff he found amidst the chaos if they're both alive.",
            "multi_add_portrait;Elspeth;Left;Garvey;Right",
            "speak;Garvey;Found dis.",
            "speak;Elspeth;K thx.",
            "#give_item;Elspeth (Elspeth);",
            "multi_remove_portrait;Elspeth;Garvey",
            "transition;close",
            "change_background",
            "end",
            "if;{v:LeodDead} == 0",
            "multi_add_portrait;Lamonte;Right;Elspeth;Left",
            "# If Leod survived Ch 2 the party talk about how they left him in the office.",
            "# Lamonte gives Elspeth an Inspire Courage staff he found amidst the chaos if they're both alive.",
            "speak;Lamonte;filler",
            "speak;Elspeth;filler",
            "#give_item;Elspeth (Elspeth);",
            "multi_remove_portrait;Lamonte;Elspeth",
            "transition;close",
            "change_background",
            "change_tilemap;Church Office",
            "add_unit;Leod (Leod);7, 5;immediate",
            "add_weather;fire",
            "transition;open;500",
            "flicker_cursor;Leod (Leod)",
            "add_portrait;Leod (Leod);Left",
            "# Leod's wakes up, barred in a burning office. Starts running around pounding on the front and back doors.",
            "speak;Leod;filler",
            "remove_portrait;Leod (Leod)",
            "move_unit;Leod (Leod);7, 8;normal;push;60",
            "add_portrait;Leod (Leod);Left",
            "bop_portrait;Leod",
            "speak;Leod;filler!",
            "bop_portrait;Leod",
            "speak;Leod;Filler!!",
            "bop_portrait;Leod",
            "speak;Leod;Filler!!!!",
            "remove_portrait;Leod (Leod)",
            "move_unit;Leod (Leod);5, 3;normal;push;60",
            "add_portrait;Leod (Leod);Left",
            "speak;Leod;IT'S LOCKED!",
            "bop_portrait;Leod (Leod)",
            "speak;Leod;AHHHHHHHHH!",
            "remove_portrait;Leod (Leod)",
            "# Leod burns to death :D",
            "transition;close;5000;255, 0, 0",
            "kill_unit;Leod (Leod);FLAG(immediate)",
            "end",
            "change_tilemap;Ch2",
            "# No text prompts here but if you want to add anything when the party actually leaves I can tweak the eventing.",
            "# It's now morning and they're headed to the Market / Pier",
            "show_layer;Boxes",
            "show_layer;Mid",
            "add_weather;sunset",
            "enable_fog_of_war;0",
            "move_cursor;11, 12",
            "transition;open",
            "wait;500",
            "add_unit;Alpin (Alpin);11, 12;immediate;stack",
            "add_unit;Carlin (Carlin);11, 12;immediate;stack",
            "add_unit;Shayla (Shayla);11, 12;immediate;stack",
            "add_unit;Zoya (Zoya);11, 12;immediate;stack",
            "add_unit;Elwynn (Elwynn);11, 12;immediate;stack",
            "add_unit;Elspeth (Elspeth);11, 12;immediate;stack",
            "add_unit;Quinley (Quinley);11, 12;immediate;stack",
            "add_unit;Sloane (Sloane);11, 12;immediate;stack",
            "if;{v:LeodDead} == 0",
            "add_unit;Lamonte (Lamonte);11, 12;immediate;stack",
            "end",
            "if;{v:LeodDead} == 1",
            "add_unit;Garvey (Garvey);11, 12;immediate;stack",
            "end",
            "move_unit;Alpin (Alpin);14, 17;normal;stack;FLAG(no_block)",
            "move_unit;Carlin (Carlin);15, 17;normal;stack;FLAG(no_block)",
            "move_unit;Shayla (Shayla);16, 17;normal;stack;FLAG(no_block)",
            "move_unit;Zoya (Zoya);17, 17;normal;stack;FLAG(no_block)",
            "move_unit;Elwynn (Elwynn);14, 17;normal;stack;FLAG(no_block)",
            "move_unit;Elspeth (Elspeth);15, 17;normal;stack;FLAG(no_block)",
            "move_unit;Quinley (Quinley);16, 17;normal;stack;FLAG(no_block)",
            "move_unit;Sloane (Sloane);17, 17;normal;stack;FLAG(no_block)",
            "if;{v:LeodDead} == 0",
            "move_unit;Lamonte (Lamonte);15, 17;normal;stack",
            "end",
            "if;{v:LeodDead} == 1",
            "move_unit;Garvey (Garvey);14, 17;normal;stack",
            "end",
            "remove_unit;Alpin (Alpin);fade;south",
            "remove_unit;Carlin (Carlin);fade;south",
            "remove_unit;Shayla (Shayla);fade;south",
            "remove_unit;Zoya (Zoya);fade;south",
            "remove_unit;Elwynn (Elwynn);fade;south",
            "remove_unit;Quinley (Quinley);fade;south",
            "remove_unit;Sloane (Sloane);fade;south",
            "remove_unit;Elspeth (Elspeth);fade;south",
            "if;{v:LeodDead} == 0",
            "remove_unit;Lamonte (Lamonte);fade;south",
            "end",
            "if;{v:LeodDead} == 1",
            "remove_unit;Garvey (Garvey);fade;south",
            "end",
            "wait;500",
            "# Castle",
            "# Cathal makes it to the castle and tells the soldiers of the invasion and is allowed inside.",
            "change_tilemap;Castle Exterior",
            "add_unit;Kingdom (Kingdom_1);3, 3;immediate",
            "add_unit;Kingdom (Kingdom_2);3, 8;immediate",
            "add_unit;Kingdom (Kingdom_3);8, 9;immediate",
            "add_unit;Kingdom (Kingdom_4);10, 9;immediate",
            "add_unit;Kingdom (Kingdom_5);3, 0;immediate",
            "add_unit;Kingdom (Kingdom_6);4, 9;immediate",
            "add_unit;Kingdom (Kingdom_7);8, 3;immediate",
            "add_unit;Kingdom (Kingdom_8);10, 3;immediate",
            "transition;open;500",
            "add_unit;Cathal (Cathal);9, 11;fade;push;south",
            "wait;500",
            "move_unit;Cathal (Cathal);9, 10;normal;push",
            "wait;500",
            "add_portrait;Cathal;Left",
            "add_portrait;SoldierBlue;MidRight",
            "add_portrait;SoldierRed;FarRight",
            "speak;SoldierBlue;Cathal!",
            "speak;Cathal;Invaded!",
            "bop_portrait;SoldierRed",
            "speak;SoldierRed;Pass!",
            "speak;Cathal;Yes, sir!",
            "multi_remove_portrait;Cathal;SoldierBlue;SoldierRed",
            "move_unit;Cathal (Cathal);9, 4;normal;push",
            "wait;500",
            "add_portrait;Cathal;Left",
            "add_portrait;SoldierBlue;MidRight",
            "add_portrait;SoldierRed;FarRight",
            "speak;SoldierBlue;Cathal!",
            "speak;Cathal;Invaded!",
            "bop_portrait;SoldierRed",
            "speak;SoldierRed;Hurry inside!",
            "speak;Cathal;Yes, sir!",
            "multi_remove_portrait;Cathal;SoldierBlue;SoldierRed",
            "move_unit;Cathal (Cathal);9, 2;normal;push",
            "wait;500",
            "remove_unit;Cathal (Cathal);immediate",
            "wait;500",
            "transition;close;500",
            "remove_all_units",
            "change_tilemap;Castle Interior",
            "add_unit;King (King);8, 4;immediate",
            "add_unit;Keeva (Keeva);7, 4;immediate",
            "add_unit;Kingdom (Kingdom_9);1, 3;immediate",
            "add_unit;Kingdom (Kingdom_10);10, 8;immediate",
            "add_unit;Kingdom (Kingdom_11);3, 3;immediate",
            "add_unit;Kingdom (Kingdom_12);6, 8;immediate",
            "add_unit;Kingdom (Kingdom_13);6, 17;immediate",
            "add_unit;Kingdom (Kingdom_14);10, 17;immediate",
            "add_unit;Kingdom (Kingdom_15);6, 13;immediate",
            "add_unit;Kingdom (Kingdom_16);10, 13;immediate",
            "add_unit;Kingdom (Kingdom_17);0, 7;immediate",
            "add_unit;Kingdom (Kingdom_18);16, 9;immediate",
            "add_unit;Kingdom (Kingdom_19);16, 11;immediate",
            "add_unit;Kingdom (Kingdom_20);0, 4;immediate",
            "add_unit;Kingdom (Kingdom_21);3, 6;immediate",
            "add_unit;Kingdom (Kingdom_22);12, 5;immediate",
            "add_unit;Kingdom (Kingdom_23);4, 5;immediate",
            "add_unit;Kingdom (Kingdom_24);13, 6;immediate",
            "move_cursor;King (King);FLAG(immediate)",
            "transition;open;500",
            "wait;500",
            "move_cursor;8, 17",
            "add_unit;Cathal (Cathal);8, 17",
            "wait;500",
            "move_unit;Cathal (Cathal);8, 10",
            "move_cursor;King (King)",
            "wait;500",
            "multi_add_portrait;Cathal;Right;King (King);Left",
            "# Once inside, Cathal's at the throneroom with the King, Keeva, and other knights.",
            "# Cathal tells him of the invasion, he expects reinforcements for the town but the king tells him to stay here and defend the castle; mentioning he's heard great things of Cathal and that he'll someday become a high ranking officer",
            "# Cathal refuses and questions how the king could abandon his people.",
            "speak;Cathal;Milord!",
            "move_portrait;King (King);MidLeft",
            "add_portrait;Keeva (Keeva);FarLeft",
            "speak;Keeva;filler",
            "speak;Cathal;Milord, village invaded...",
            "multi_remove_portrait;Cathal;King (King);Keeva (Keeva)",
            "move_unit;King (King);8, 8;normal;push;FLAG(no_follow)",
            "move_unit;Keeva (Keeva);7, 7;normal;push;FLAG(no_follow)",
            "wait;500",
            "multi_add_portrait;Cathal;Right;King (King);Left",
            "# The king gives a speech about how sacrifices are necessary for the greater good of the kingdom (or whatever along those lines)",
            "# King tells Cathal to get in line",
            "    # Cathal retorts with some humanitarian response and refuses. Then he tries to leave.",
            "speak;King (King);(Speech)",
            "multi_remove_portrait;Cathal;King (King)",
            "move_unit;Cathal (Cathal);8, 12;normal;FLAG(no_block);FLAG(no_follow)",
            "move_unit;Kingdom (Kingdom_15);8, 13;normal;FLAG(no_block);FLAG(no_follow)",
            "move_unit;Kingdom (Kingdom_16);9, 13;normal",
            "wait;500",
            "multi_add_portrait;SoldierBlue;FarLeft;SoldierRed;MidLeft;Cathal;Right",
            "# Soldiers stop Cathal on his way out",
            "speak;SoldierBlue;Halt!",
            "multi_remove_portrait;SoldierBlue;SoldierRed;Cathal",
            "wait;500",
            "flicker_cursor;King (King)",
            "wait;500",
            "add_portrait;King (King);Left",
            "# King tells them to let him go, he has no use for a soldier who won't follow orders (or whatever)",
            "speak;King (King);filler",
            "remove_portrait;King (King)",
            "wait;500",
            "move_unit;Kingdom (Kingdom_15);7, 13;normal;FLAG(no_block)",
            "move_unit;Kingdom (Kingdom_16);10, 13;normal",
            "wait;500",
            "move_unit;Cathal (Cathal);8, 17;normal;push",
            "wait;500",
            "remove_unit;Cathal (Cathal);fade;south",
            "wait;500",
            ""
        ]
    }
]